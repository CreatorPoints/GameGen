<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Photon Studios - Shop</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    overflow-x: hidden;
    font-family: Arial, sans-serif;
    color: white;
    background: #1b2838;
  }

  #bg-video {
    position: fixed; top: 0; left: 0;
    width: 100vw; height: 100vh;
    object-fit: cover;
    z-index: -2;
  }
  .dark-overlay {
    position: fixed; top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(0, 0, 0, 0.85);
    z-index: -1;
  }

  /* Navbar */
  .navbar {
    position: fixed; top: 0;
    width: 100%; padding: 15px 40px;
    display: flex; justify-content: space-between; align-items: center;
    background: rgba(0,0,0,0.7);
    backdrop-filter: blur(12px);
    z-index: 100;
  }
  .logo { font-size: 1.8rem; font-weight: bold; }
  .nav-links { display: flex; gap: 25px; }
  .nav-links a {
    color: #ccc; text-decoration: none; transition: 0.3s;
  }
  .nav-links a:hover { color: #fff; }

  #loginBtn {
    padding: 8px 16px;
    background: #5aa9e6;
    border: none; border-radius: 4px;
    cursor: pointer; transition: 0.3s;
    font-weight: bold; color: white;
  }
  #loginBtn:hover { background: #4a99d6; }

  .container { padding: 120px 40px 40px; }

  .page-title { font-size: 2.3rem; text-align: center; margin-bottom: 20px; }

  /* Search + Filter */
  .controls {
    display: flex; justify-content: center;
    gap: 20px; margin-bottom: 30px;
  }
  .search-bar {
    width: 280px; padding: 10px 15px; border-radius: 6px;
    border: none; outline: none; font-size: 1rem;
  }
  .filter-select {
    padding: 10px 15px; border-radius: 6px;
    border: none; outline: none; font-size: 1rem;
  }

  /* Game Grid */
  .games-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 25px;
  }

  .game-card {
    background: rgba(30, 40, 50, 0.8);
    border-radius: 8px; overflow: hidden;
    transition: 0.3s; cursor: pointer;
  }
  .game-card:hover { transform: translateY(-8px); }
  .game-image { width: 100%; height: 170px; object-fit: cover; }
  .game-info { padding: 15px; }
  .game-title { font-size: 1.2rem; margin-bottom: 4px; }
  .game-genre { font-size: 0.9rem; color: #8ab4f8; margin-bottom: 8px; }
  .game-price { font-size: 1rem; color: #5aa9e6; }
</style>
</head>
<body>

<video id="bg-video" autoplay muted loop>
  <source src="videos/blackhole.mp4" type="video/mp4" />
</video>
<div class="dark-overlay"></div>

<!-- NAVBAR -->
<div class="navbar">
  <div class="logo">PHOTON STUDIOS</div>
  <div class="nav-links">
    <a href="index.html">Home</a>
    <a href="#shop">Shop</a>
  </div>
  <button id="loginBtn">Login</button>
</div>

<!-- MAIN CONTENT -->
<div class="container">
  <h1 class="page-title">Photon Store</h1>

  <div class="controls">
    <input type="text" id="searchInput" class="search-bar" placeholder="Search games...">
    <select id="filterSelect" class="filter-select">
      <option value="all">All Genres</option>
      <option value="Action">Action</option>
      <option value="Horror">Horror</option>
      <option value="Puzzle">Puzzle</option>
      <option value="Sci-Fi">Sci-Fi</option>
    </select>
  </div>

  <!-- GAME GRID -->
  <div class="games-grid" id="gamesGrid"></div>
</div>

<!-- FIREBASE -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getAuth, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCsulwdk4ryzoCwpuKji5a8b-jXeG5ews4",
    authDomain: "photon-userbase.firebaseapp.com",
    projectId: "photon-userbase",
    storageBucket: "photon-userbase.firebasestorage.app",
    messagingSenderId: "66493624110",
    appId: "1:66493624110:web:d820995afc5b2bcad354bf",
    measurementId: "G-9RJRPKKNZV"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const provider = new GoogleAuthProvider();

  document.getElementById("loginBtn").onclick = () => {
    signInWithPopup(auth, provider)
      .then(res => alert("Logged in as " + res.user.displayName))
      .catch(err => alert(err));
  };

  // Load games from Firestore
  async function loadGames() {
    const gamesRef = collection(db, "games");
    const snapshot = await getDocs(gamesRef);
    let games = [];
    snapshot.forEach(doc => games.push({ id: doc.id, ...doc.data() }));
    renderGames(games);

    document.getElementById("searchInput").oninput = () => applyFilters(games);
    document.getElementById("filterSelect").onchange = () => applyFilters(games);
  }

  function applyFilters(games) {
    const search = document.getElementById("searchInput").value.toLowerCase();
    const filter = document.getElementById("filterSelect").value;

    const filtered = games.filter(g =>
      g.title.toLowerCase().includes(search) &&
      (filter === "all" || g.genre === filter)
    );
    renderGames(filtered);
  }

  function renderGames(list) {
    const grid = document.getElementById("gamesGrid");
    grid.innerHTML = "";
    list.forEach(g => {
      grid.innerHTML += `
        <div class="game-card" onclick="location.href='game_${g.id}.html'">
          <img src="${g.thumbnail}" class="game-image">
          <div class="game-info">
            <div class="game-title">${g.title}</div>
            <div class="game-genre">${g.genre}</div>
            <div class="game-price">${g.price}</div>
          </div>
        </div>`;
    });
  }

  loadGames();
</script>
</body>
</html>